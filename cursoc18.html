<HTML><!-- InstanceBegin template="/Templates/plantilla.dwt" codeOutsideHTMLIsLocked="false" -->

<HEAD>
  <!-- InstanceBeginEditable name="doctitle" -->
  <TITLE>Curso de C - Redireccionamiento</TITLE>
  <!-- InstanceEndEditable -->
  <meta name="decription" content="Curso de C - Introducci�n">
  <meta name="keywords" content="Programaci&oacute;n, Curso de C, C">
  <META NAME="GENERATOR" CONTENT="Arachnophilia 3.5">
  <META NAME="FORMATTER" CONTENT="Arachnophilia 3.5">
  <meta name="author" content="Gorka Urrutia">
  <meta name="DC.Creator" content="Gorka Urrutia">
  <META name="robots" content="noindex, nofollow">
  <link rel="stylesheet" href="cursoc.css">
  <!-- InstanceBeginEditable name="head" -->


  <!-- InstanceEndEditable -->
</HEAD>

<BODY>
  <a name="arriba"></a>

  <table width="100%" border="0">
    <tr>
      <td align="left"><img src="cursoc.gif" alt="Curso de C" border="0">
      </td>
      <td align="right"><a href="http://www.elrincondelc.com" target="_top"><img src="colibri.gif"
            alt="El Rinc�n del C - www.elrincondelc.com" border="0"></a>
      </td>
    </tr>
  </table>
  <!-- InstanceBeginEditable name="Titulo" -->
  <h1>Redireccionamiento</h1><!-- InstanceEndEditable -->


  <p class="barranavegaciontop"><!-- InstanceBeginEditable name="BarraNavegacion" -->
    <a href="cursoc17.html">[Anterior]</a> <a href="cursoc19.html">[Siguiente]</a>
    <a href="index.html" target="_top">[Contenido]</a>
    <!-- InstanceEndEditable -->
  </p>

  <!-- InstanceBeginEditable name="Cuerpo" -->
  <A NAME="contenido"></A>
  <H2>
    Contenido
  </H2>

  <UL>
    <LI><A HREF="#quees" CLASS="enlace">¿Qué es la redirección?</A>
    <LI><A HREF="#salida" CLASS="enlace">Redireccionar la salida</A>
    <LI><A HREF="#salidaplus" CLASS="enlace">Redireccionar la salida con &gt;&gt;</A>
    <LI><A HREF="#entrada" CLASS="enlace">Redireccionar la entrada</A>
    <LI><A HREF="#freopen" CLASS="enlace">Redireccionar desde el programa - freopen</A>
    <LI><A HREF="#ejercicios" CLASS="enlace">Ejercicios</A>
  </UL>


  <A NAME="quees"></A>
  <H2>
    ¿Qué es la redirección?
  </H2>

  <p>Cuando ejecutamos el comando <I>dir</I> se nos muestra el resultado en la pantalla. Sin embargo podemos hacer que
    el resultado se guarde en un fichero haciendo:</p>

  <DIV CLASS="ejemplo">
    <PRE>
dir > resultado.txt
</PRE>
  </DIV>

  <p>De esta forma el listado de directorios quedará guardado en el fichero <I>resultado.txt</I> y no se mostrará en la
    pantalla.</p>

  <p>Esto es lo que se llama <strong>redirección</strong>. En este ejemplo lo que hemos hecho ha sido redireccionar la
    salida utilizando '&gt;'.</p>

  <p>La salida del programa se dirige hacia la salida estándar (stdout, standard output). Normalmente, si no se
    especifica nada, la salida standard es la pantalla.</p>

  <p>La entrada de datos al programa se hace desde la entrada estándar (stdin, standard input). Normalmente, por defecto
    es el teclado.</p>

  <p>Existe una tercera opción que es la salida de error estándar (stderr, standard error). Aquí es donde se muestran
    los mensajes de error del programa al usuario. Normalmente suele ser la pantalla, al igual que la de salida. ¿Por
    qué tenemos stderr y stdout? Porque de esta forma podemos redireccionar la salida a un fichero y aún así podemos ver
    los mensajes de error en pantalla.</p>

  <p>Stdin, stdout y stderr en realidad hay que verlos como ficheros:</p>

  <ul class="texto">
    <li>Si stdout es la pantalla, cuando usemos printf, el resultado se muestra en el monitor de nuestro ordenador.
      Podemos imaginar que stdout es un fichero cuyo contenido se muestra en la pantalla.
    <li>Si stdin es el teclado imaginemos que lo que tecleamos va a un fichero cuyo contenido lee el programa.
  </ul>

  <p class="volver"><a href="#arriba">[Arriba]</a></p>

  <A NAME="salida"></A>
  <H2>
    Redireccionar la salida
  </H2>

  <p>Ya hemos visto cómo se redirecciona la salida con el dir. Ahora vamos a aplicarlo a nuestro curso con un sencillo
    ejemplo. Vamos a ver un programa que toma los datos del teclado y los muestra en la pantalla. Si el usuario teclea
    'salir' el programa termina:</p>

  <DIV CLASS="ejemplo">
    <PRE>
#include &lt;stdio.h&gt;

int main()
    {
    char texto[100];

    gets(texto);
    do {
       printf( "%s\n",texto );
       gets(texto);
       } while ( strcmp(texto, "salir") != 0 );
    <B>fprintf</B>( <B>stderr</B>, "El usuario ha tecleado 'salir'" );
    }
</PRE>
    <DIV CLASS="comprobado">Comprobado con DJGPP</DIV>
  </DIV>

  <p>En este programa tenemos una función nueva: <strong>fprintf</strong>. Esta función permite escribir en el fichero
    indicado. Su formato es el siguiente:</p>

  <DIV CLASS="ejemplo">
    <PRE>
	int fprintf(FILE *fichero, const char *formato, ...);
</PRE>
  </DIV>

  <p>Ya veremos esta función más adelante. Por ahora nos basta con saber que funciona como printf pero nos permite
    indicar en qué fichero queremos que se escriba el texto. En nuestro ejemplo <I>fichero=stderr</I>.</p>

  <p>Como ya hemos visto antes <I>stderr</I> es un fichero. Stderr es la pantalla, así que, si escribimos el texto en el
    fichero stderr lo podremos ver en el monitor.</p>

  <p>Si ejecutamos el programa como hemos hecho hasta ahora tendremos el siguiente resultado (en negrita lo que
    tecleamos nosotros):</p>

  <DIV CLASS="ejemplo">
    <PRE>
<B>primera línea</B>
primera línea
<B>segunda</B>
segunda
<B>esto es la monda</B>
esto es la monda
<B>salir</B>
El usuario ha tecleado 'salir'
</PRE>
  </DIV>

  <p>Como vemos el programa repite lo que tecleamos.</p>

  <p>Si ahora utilizamos la redirección '<B>&gt; resultado.txt</B>' el resultado por pantalla será (en negrita lo que
    tecleamos nosotros):</p>

  <DIV CLASS="ejemplo">
    <PRE>
<B>primera línea
segunda
esto es la monda
salir</B>
El usuario ha tecleado 'salir'
</PRE>
  </DIV>

  <p>NOTA: Seguimos viendo el mensaje final (<I>El usuario ha tecleado 'salir'</I>) porque stderr sigue siendo la
    pantalla.</p>

  <p>y se habrá creado un fichero llamado <I>resultado.txt</I> cuyo contenido será:</p>

  <DIV CLASS="ejemplo">
    <PRE>
primera línea
segunda
esto es la monda
</PRE>
  </DIV>

  <p>Si no hubiésemos usado stderr el mensaje final hubiese ido a stdout (y por lo tanto al fichero), así que no
    podríamos haberlo visto en la pantalla. Hubiera quedado en el fichero resultado.txt.</p>

  <p class="volver"><a href="#arriba">[Arriba]</a></p>

  <A NAME="salidaplus"></A>
  <H2>
    Redireccionar la salida con &gt;&gt;
  </H2>

  <p>Existe una forma de redireccionar la salida de forma que se añada a un fichero en vez de sobreescribirlo. Para ello
    debemos usar '&gt;&gt;' en vez de '&gt;'. Haz la siguiente prueba:</p>

  <DIV CLASS="ejemplo">
    <PRE>
dir &gt; resultado.txt
dir &gt;&gt; resultado.txt
</PRE>
  </DIV>

  <p>Tendrás el listado del directorio dos veces en el mismo fichero. La segunda vez que llamamos al comando dir, si
    usamos &gt;&gt;, se añade al final del fichero.</p>

  <A NAME="aviso"></A>
  <H3>Aviso</H3>

  <p>Todo esto nos sirve como una introducción al mundo de los ficheros, pero puede no ser la forma más cómoda para
    trabajar con ella (aunque como hemos visto es muy sencilla). El tema de los ficheros lo veremos m�s a fondo en el
    siguiente capítulo.</p>

  <p class="volver"><a href="#arriba">[Arriba]</a></p>

  <A NAME="entrada"></A>
  <H2>
    Redireccionar la entrada
  </H2>

  <p>Ahora vamos a hacer algo curioso. Vamos a crear un fichero llamado <I>entrada.txt</I> y vamos a usarlo como entrada
    de nuestro programa. Vamos a redireccionar la entrada al fichero entrada.txt. El fichero entrada.txt debe contener
    lo siguiente:</p>

  <DIV CLASS="ejemplo">
    <PRE>
Esto no lo he tecleado yo.
Se escribe sólo.
Qué curioso.
salir
</PRE>
  </DIV>

  <p>Es importante la última línea 'salir' porque si no podemos tener unos resultados curiosos (en mi caso una sucesión
    infinita de 'Qué curioso.'.</p>

  <p>Para cambiar la entrada utilizamos el símbolo '&lt;'. Si nuestro programa lo hemos llamado <B>stdout.c</B> haremos:
  </p>

  <DIV CLASS="ejemplo">
    <PRE>
# stdout &lt; entrada.txt
</PRE>
  </DIV>

  <p>y tendremos:</p>

  <DIV CLASS="ejemplo">
    <PRE>
primera línea
segunda
esto es la monda
El usuario ha tecleado 'salir'
</PRE>
  </DIV>

  <p>Increíble, hemos escrito todo eso sin tocar el teclado. Lo que sucede es que el programa toma los datos del fichero
    entrada.txt en vez del teclado. Cada vez que encuentra un salto de línea (el final de una línea) es equivalente a
    cuando pulsamos el 'Enter'.</p>

  <p>Podemos incluso hacer una doble redirección: Tomaremos como entrada <I>entrada.txt</I> y como salida
    <i>resultado.txt</i>:
  </p>

  <DIV CLASS="ejemplo">
    <PRE>
stdout &lt; entrada.txt &gt; resultado.txt
</PRE>
  </DIV>

  <p>NOTA: Cambiando el orden también funciona:</p>

  <DIV CLASS="ejemplo">
    <PRE>
stdout &gt; resultado.txt &lt; entrada.txt
</PRE>
  </DIV>

  <p class="volver"><a href="#arriba">[Arriba]</a></p>

  <A NAME="freopen"></A>
  <H2>
    Redireccionar desde el programa - freopen
  </H2>

  <p>Existe una forma de cambiar la salida estándar desde el propio programa. Esto se puede conseguir utilizando la
    función <strong>freopen</strong>:</p>

  <DIV CLASS="ejemplo">
    <PRE>
	FILE *freopen(const char *nombre_fichero, const char *modo, FILE *fichero);
</PRE>
  </DIV>

  <p>Esta función hace que el fichero al que apunta <i>fichero</i> se cierre y se abra pero apuntando a un nuevo fichero
    llamado <i>nombre_fichero</i>. Para redireccionar la salida con este método podemos hacer:</p>

  <DIV CLASS="ejemplo">
    <PRE>
#include &lt;stdio.h&gt;

int main()
    {
    char texto[100];

    <B>freopen( "resultado.txt","wb",stdout );</B>
    gets(texto);
    do {
       printf( "%s\n",texto );
       gets(texto);
       } while ( strcmp(texto, "salir") != 0 );
    fprintf( stderr, "El usuario ha tecleado 'salir'" );
    }
</PRE>
  </DIV>

  <p>En este programa la función freopen cierra el fichero <i>stdout</i>, que es la pantalla, y lo abre apuntando al
    fichero <i>resultado.txt</i>. Ya veremos esta función más adelante.</p>

  <p class="volver"><a href="#arriba">[Arriba]</a></p>

  <!-- InstanceEndEditable -->
  <p class="barranavegacionabajo"><!-- InstanceBeginEditable name="PieNavegacion" -->
    <a href="cursoc17.html">[Anterior]</a> <a href="cursoc19.html">[Siguiente]</a>
    <a href="index.html" target="_top">[Contenido]</a>
    <A HREF="mailto:cursoc@elrincondelc.com" class="nombre">
      -----------------------------------------------------------------------------------------------------------------
      ISC.
      Jose Nicolas Jimenez Hernandez</A>
    <!-- InstanceEndEditable -->
  </p>
</BODY>

<!-- InstanceEnd -->

</HTML>